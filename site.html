<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>簡易ホームページ作成フォーム</title>
    <style>
       body { font-family: sans-serif; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; }
        input[type="text"], select, textarea { width: 100%; padding: 8px; box-sizing: border-box; }
        button { padding: 10px 15px; cursor: pointer; }
        #mockup-container { margin-top: 20px; border: 1px solid #ccc; padding: 20px; }
        .header { background-color: #eee; padding: 10px; text-align: center; }
        .hero { background-color: #f9f9f9; padding: 20px; text-align: center; }
        .section { margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; }
        .footer { background-color: #eee; padding: 10px; text-align: center; }

        #form-section {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            position: relative; /* ボタンの絶対配置の基準 */
        }

        #form-content {
            /* 初期表示 */
        }
        .form-toggle-button {
            position: absolute;
            bottom: -15px; /* 下辺から少し下 */
            left: 50%;
            transform: translateX(-50%); /* 中央揃え */
            padding: 5px 10px;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.2em;
            line-height: 1;
        }

        .form-toggle-button:focus {
            outline: none;
        }        

        #toggle-form {
            margin-top: 10px;
        }

        .hamburger-menu {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        #hamburger-toggle {
            padding: 10px 15px;
            cursor: pointer;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        #hamburger-content {
            display: none;
            flex-direction: column;
            background-color: #f9f9f9;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            margin-top: 5px;
            gap: 10px;
            align-items: flex-start;
        }

        #hamburger-content > button {
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            border: none;
            background-color: #eee;
            cursor: pointer;
            border-radius: 3px;
            text-align: left;
        }

        #version-sidebar {
            margin-top: 10px;
            border-top: 1px solid #ddd;
            padding-top: 10px;
        }

        #version-sidebar h3 {
            margin-top: 0;
        }

        #version-sidebar ul {
            list-style-type: none;
            padding: 0;
        }

        #version-sidebar ul li {
            margin-bottom: 5px;
        }

        #version-sidebar ul li button {
            margin-left: 5px;
            padding: 5px 8px;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div id="form-section">
        <h1>簡易ホームページ作成フォーム</h1>
        
        <div id="form-content">
            <div class="form-group">
                <label for="industry">業種:</label>
                <input type="text" id="industry" name="industry">
            </div>
            <div class="form-group">
                <label for="purpose">サイトの目的:</label>
                <input type="text" id="purpose" name="purpose">
            </div>
            <div class="form-group">
                <label for="color">カラーテーマ:</label>
                <input type="text" id="color" name="color" placeholder="例：青、緑、ピンクなど">
            </div>
            <div class="form-group">
                <label for="catchphrase">キャッチフレーズ:</label>
                <input type="text" id="catchphrase" name="catchphrase">
            </div>
            <div class="form-group">
                <label>必要なコンテンツ:</label>
                <label><input type="checkbox" name="content" value="店舗紹介"> 店舗紹介</label><br>
                <label><input type="checkbox" name="content" value="メニュー/商品紹介"> メニュー/商品紹介</label><br>
                <label><input type="checkbox" name="content" value="お知らせ"> お知らせ</label><br>
                <label><input type="checkbox" name="content" value="アクセス"> アクセス</label><br>
                <label><input type="checkbox" name="content" value="問い合わせ"> 問い合わせ</label><br>
                <label><input type="checkbox" name="content" value="SNSリンク"> SNSリンク</label><br>
            </div>
            <div id="content-details">
                </div>
            <button id="generate-button" onclick="generateMockup()">モックアップ生成</button>
        </div>
        <button id="toggle-form" class="form-toggle-button">▼</button>
    </div>

    <h2>生成されたモックアップ</h2>
    <div id="mockup-container">
        </div>

    <div class="hamburger-menu">
        <button id="hamburger-toggle">☰ メニュー</button>
        <div id="hamburger-content">
            <button id="save-button">モックアップを保存</button>
            <button id="load-button">モックアップを読み込み</button>
            <button id="toggle-history">バージョン履歴を開く</button>
            <div id="version-sidebar">
                <h3>バージョン履歴</h3>
                <ul id="version-history-list"></ul>
            </div>
            <label for="font-selector">フォント:</label>
            <select id="font-selector">
                <option value="">デフォルト</option>
                <option value="Arial, sans-serif">Arial</option>
                <option value="Helvetica, sans-serif">Helvetica</option>
                <option value="'Times New Roman', serif">Times New Roman</option>
                <option value="'Courier New', monospace">Courier New</option>
                <option value="Georgia, serif">Georgia</option>
                <option value="Verdana, sans-serif">Verdana</option>
                <option value="'MS Pゴシック', sans-serif">MS Pゴシック</option>
                <option value="'Yu Gothic', sans-serif">游ゴシック</option>
                </select>
        </div>
    </div>

    <script>
const formSection = document.getElementById('form-section');
        const formContent = document.getElementById('form-content');
        const generateButton = document.getElementById('generate-button');
        const toggleFormButton = document.getElementById('toggle-form');
        const contentDetailsDiv = document.getElementById('content-details');
        const contentCheckboxes = document.querySelectorAll('input[name="content"]');
        const mockupContainer = document.getElementById('mockup-container');
        const hamburgerToggle = document.getElementById('hamburger-toggle');
        const hamburgerContent = document.getElementById('hamburger-content');
        const saveButton = document.getElementById('save-button');
        const loadButton = document.getElementById('load-button');
        const toggleHistoryButton = document.getElementById('toggle-history');
        const versionSidebar = document.getElementById('version-sidebar');
        const fontSelector = document.getElementById('font-selector');
        let activeElementForFontChange = null;
        const historyList = document.getElementById('version-history-list');
        let versions = [];
        let saveTimer;
        let formVisible = true;
        let currentlyEditing = null;

        contentCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                contentDetailsDiv.innerHTML = '';
                contentCheckboxes.forEach(cb => {
                    if (cb.checked) {
                        const label = document.createElement('label');
                        label.textContent = `${cb.value}の内容:`;
                        const textarea = document.createElement('textarea');
                        textarea.name = `${cb.value.replace('/', '_')}_text`;
                        contentDetailsDiv.appendChild(label);
                        contentDetailsDiv.appendChild(textarea);
                        contentDetailsDiv.appendChild(document.createElement('br'));
                    }
                });
            });
        });

        function generateMockup() {
            const industry = document.getElementById('industry').value;
            const purpose = document.getElementById('purpose').value;
            const color = document.getElementById('color').value;
            const catchphrase = document.getElementById('catchphrase').value;
            const selectedContents = Array.from(document.querySelectorAll('input[name="content"]:checked')).map(cb => cb.value);
            const contentTexts = {};
            selectedContents.forEach(content => {
                const textarea = document.querySelector(`textarea[name="${content.replace('/', '_')}_text"]`);
                if (textarea) {
                    contentTexts[content] = textarea.value;
                }
            });

            let mockupHTML = `
                <div class="header" style="background-color: ${color}; color: #fff;">
                    <h1>[ロゴ]</h1>
                    <nav>
                        ${selectedContents.map(content => `<a href="#${content.replace('/', '-')}">${content}</a>`).join(' | ')}
                    </nav>
                </div>
                <div class="hero" style="background-color: #f9f9f9;">
                    <img src="https://via.placeholder.com/800x300?text=Hero+Image" alt="ヒーロー画像" style="max-width: 100%;">
                    <h2>${catchphrase}</h2>
                </div>
            `;

            if (selectedContents.includes('店舗紹介')) {
                mockupHTML += `
                    <div id="店舗紹介" class="section">
                        <h3>店舗紹介</h3>
                        <img src="https://via.placeholder.com/300x200?text=Store+Image" alt="店舗画像" class="editable-image" data-image-id="store-image" style="float: left; margin-right: 15px;">
                        <p contentEditable="true">${contentTexts['店舗紹介'] || 'ここに店舗紹介が入ります。'}</p>
                        <div style="clear: both;"></div>
                    </div>
                `;
            }

            if (selectedContents.includes('メニュー/商品紹介')) {
                mockupHTML += `
                    <div id="メニュー-商品紹介" class="section">
                        <h3>メニュー/商品紹介</h3>
                        <p contentEditable="true">${contentTexts['メニュー/商品紹介'] || 'ここにメニューや商品の紹介が入ります。'}</p>
                        <table>
                            <thead>
                                <tr><th>商品名</th><th>価格</th></tr>
                            </thead>
                            <tbody>
                                <tr><td>商品A</td><td>1,000円</td></tr>
                                <tr><td>商品B</td><td>2,000円</td></tr>
                            </tbody>
                        </table>
                    </div>
                `;
            }

            if (selectedContents.includes('お知らせ')) {
                mockupHTML += `
                    <div id="お知らせ" class="section">
                        <h3>お知らせ</h3>
                        <p contentEditable="true">${contentTexts['お知らせ'] || 'ここにお知らせが入ります。'}</p>
                        <ul>
                            <li>2023年X月X日：新しいサービスを開始しました。</li>
                        </ul>
                    </div>
                `;
            }

            if (selectedContents.includes('アクセス')) {
                mockupHTML += `
                    <div id="アクセス" class="section">
                        <h3>アクセス</h3>
                        <p contentEditable="true">${contentTexts['アクセス'] || 'ここにアクセス情報が入ります。'}</p>
                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3241.745777342719!2d139.5362846152564!3d35.3354288802035!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x6018578a5769c995%3A0x994c38314c11505c!2z5rWc5Y2X6aeF!5e0!3m2!1sja!2sjp!4v1682345678901!5m2!1sja!2sjp" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
                    </div>
                `;
            }

            if (selectedContents.includes('問い合わせ')) {
                mockupHTML += `
                    <div id="問い合わせ" class="section">
                        <h3>問い合わせ</h3>
                        <p contentEditable="true">${contentTexts['問い合わせ'] || 'ここにお問い合わせフォームが入ります。'}</p>
                        <form>
                            <label for="name">お名前:</label><br>
                            <input type="text" id="name" name="name"><br>
                            <label for="email">メールアドレス:</label><br>
                            <input type="email" id="email" name="email"><br>
                            <label for="message">お問い合わせ内容:</label><br>
                            <textarea id="message" name="message"></textarea><br><br>
                            <button type="submit">送信</button>
                        </form>
                    </div>
                `;
            }

            if (selectedContents.includes('SNSリンク')) {
                mockupHTML += `
                    <div class="footer" style="background-color: ${color}; color: #fff;">
                        <p contentEditable="true">SNS:</p>
                        ${contentTexts['SNSリンク'] ? contentTexts['SNSリンク'].split(',').map(link => `<a href="${link.trim()}" target="_blank">Link</a>`).join(' | ') : 'ここにSNSリンクが入ります（カンマ区切りでURLを入力してください）。'}
                    </div>
                `;
            }

            mockupContainer.innerHTML = mockupHTML;
            formContent.style.display = 'none';
            formVisible = false;
            toggleFormButton.textContent = '▼';
        }

        mockupContainer.addEventListener('click', (event) => {
            const editableElement = event.target.closest('h1[contentEditable="true"], h2[contentEditable="true"], h3[contentEditable="true"], p[contentEditable="true"], td[contentEditable="true"]');

            if (editableElement) {
                if (currentlyEditing && currentlyEditing !== editableElement) {
                    currentlyEditing.contentEditable = false;
                    currentlyEditing.style.border = '';
                }
                currentlyEditing = editableElement;
                currentlyEditing.contentEditable = true;
                currentlyEditing.focus();
                currentlyEditing.style.border = '2px dashed blue';
                activeElementForFontChange = currentlyEditing;
                fontSelector.value = window.getComputedStyle(activeElementForFontChange).fontFamily;
            } else if (event.target.classList.contains('editable-image')) {
                if (currentlyEditing) {
                    currentlyEditing.contentEditable = false;
                    currentlyEditing.style.border = '';
                    currentlyEditing = null;
                    activeElementForFontChange = null;
                }
                const currentSrc = event.target.src;
                const newSrc = prompt('新しい画像のURLを入力してください:', currentSrc);
                if (newSrc) {
                    event.target.src = newSrc;
                    saveVersion('(画像変更)');
                }
            } else if (currentlyEditing && !editableElement && event.target !== currentlyEditing) {
                currentlyEditing.contentEditable = false;
                currentlyEditing.style.border = '';
                currentlyEditing = null;
                activeElementForFontChange = null;
            }
        });

        mockupContainer.addEventListener('blur', (event) => {
            if (event.target === currentlyEditing) {
                currentlyEditing.contentEditable = false;
                currentlyEditing.style.border = '';
                currentlyEditing = null;
                activeElementForFontChange = null;
            }
        }, true); // キャプチャリングフェーズで blur イベントを処理

        mockupContainer.addEventListener('mouseover', () => {
            const editableElements = mockupContainer.querySelectorAll('h1[contentEditable="true"], h2[contentEditable="true"], h3[contentEditable="true"], p[contentEditable="true"], td[contentEditable="true"], .editable-image');
            editableElements.forEach(element => {
                element.style.cursor = 'pointer';
            });
        });

        fontSelector.addEventListener('change', () => {
            if (activeElementForFontChange) {
                activeElementForFontChange.style.fontFamily = fontSelector.value;
                saveVersion('(フォント変更)');
            }
        });

        function saveMockup() {
            const title = prompt('バージョン名を入力してください (任意):');
            saveVersion(title);
        }

        function loadMockup() {
            const savedHTML = localStorage.getItem('mockupHTML');
            if (savedHTML) {
                mockupContainer.innerHTML = savedHTML;
                alert('保存されたモックアップを読み込みました。');
            } else {
                alert('保存されたモックアップはありません。');
            }
        }

        function saveVersion(title) {
            const timestamp = new Date();
            const versionData = {
                title: title || `v${versions.length + 1}`,
                timestamp: timestamp.toISOString(),
                html: mockupContainer.innerHTML
            };
            versions.push(versionData);
            versions.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            localStorage.setItem('mockupVersions', JSON.stringify(versions));
            updateVersionList();
            alert(`バージョン "${versionData.title}" を保存しました (${new Date(versionData.timestamp).toLocaleString()})。`);
        }

        function loadVersion(index) {
            if (index >= 0 && index < versions.length) {
                mockupContainer.innerHTML = versions[index].html;
                alert(`バージョン "${versions[index].title}" (${new Date(versions[index].timestamp).toLocaleString()}) を読み込みました。`);
            } else {
                alert('指定されたバージョンは存在しません。');
            }
        }

        function updateVersionList() {
            historyList.innerHTML = '';
            versions.forEach((version, index) => {
                const listItem = document.createElement('li');
                const link = document.createElement('a');
                link.href = '#';
                link.textContent = `${version.title} (${new Date(version.timestamp).toLocaleString()})`;
                link.onclick = () => loadVersion(index);
                listItem.appendChild(link);

                const restoreButton = document.createElement('button');
                restoreButton.textContent = '復元';
                restoreButton.style.marginLeft = '5px';
                restoreButton.onclick = () => {
                    mockupContainer.innerHTML = version.html;
                    saveVersion('(復元) ' + version.title);
                    alert(`バージョン "${version.title}" を復元し、新しいバージョンとして保存しました。`);
                };
                listItem.appendChild(restoreButton);

                historyList.appendChild(listItem);
            });
        }

        hamburgerToggle.addEventListener('click', () => {
            hamburgerContent.style.display = hamburgerContent.style.display === 'none' ? 'flex' : 'none';
        });

        saveButton.addEventListener('click', saveMockup);
        loadButton.addEventListener('click', loadMockup);

        toggleHistoryButton.addEventListener('click', () => {
            versionSidebar.style.display = versionSidebar.style.display === 'none' ? 'block' : 'none';
            toggleHistoryButton.textContent = versionSidebar.style.display === 'none' ? 'バージョン履歴を開く' : 'バージョン履歴を閉じる';
        });

        mockupContainer.addEventListener('input', () => {
            clearTimeout(saveTimer);
            saveTimer = setTimeout(() => {
                saveVersion();
            }, 10000);
        });

        toggleFormButton.addEventListener('click', () => {
            formContent.style.display = formContent.style.display === 'none' ? 'block' : 'none';
            toggleFormButton.textContent = formContent.style.display === 'none' ? '▼' : '▲';
            formVisible = !formVisible;
        });

        const storedVersions = localStorage.getItem('mockupVersions');
        if (storedVersions) {
            versions = JSON.parse(storedVersions);
            versions.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            updateVersionList();
        }
    </script>
</body>
</html>